<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<script>(window.dataLayer=window.dataLayer||[]).push({event:'gtm.js','gtm.start':+new Date()})</script>
<script async src="https://www.googletagmanager.com/gtm.js?id=GTM-MVPNN2"></script>
<title>Verify a Sync Gateway Install | Couchbase Capella Staging Docs</title>
<link rel="canonical" href="https://docs.stage.nonprod-project-avengers.com/sync-gateway/3.0/get-started-verify-install.html">
<link rel="stylesheet" href="../../_/css/site.css">
<script src="../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Configure and verify your &lt;em&gt;Sync Gateway&lt;/em&gt; installation; securely sync enterprise data from cloud to edge!">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="sync-gateway">
<meta name="dcterms.identifier" content="3.0">
<meta name="page-url" content="/sync-gateway/3.0/get-started-verify-install.html">
<meta name="generator" content="Antora 3.0.1">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.stage.nonprod-project-avengers.com/cloud/index.html">
                    <img src="../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://docs.stage.nonprod-project-avengers.com/cloud/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../cloud/index.html">
                      Capella
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="2">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/hakimcassimally/couchbase/docs-sync-gateway/modules/ROOT/pages/get-started-verify-install.adoc" title="Edit Page" target="_blank" rel="noopener" class="remove-ext-icon">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="index.html">Sync Gateway</a></li>
<li class="crumb">Start Here!</li>
<li class="crumb"><a href="get-started-verify-install.html">Verify</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Verify a Sync Gateway Install</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>Configure and verify your <em>Sync Gateway</em> installation; securely sync enterprise data from cloud to edge!<br>
This is <strong>Step 4</strong> in the <em>Start Here!</em> topic group. Here we will verify that you can connect your <em>sync&#160;gateway</em> to a <em>Couchbase Server</em> and synchronize changes whether made in Couchbase Server or through sync&#160;gateway&#8217;s REST API.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Related <em>Start Here!</em> topics: <a href="introduction.html" class="xref page">Introduction</a>  |  <a href="get-started-prepare.html" class="xref page">Prepare</a>  |  <a href="get-started-install.html" class="xref page">Install</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Preparatory Steps</div>
Ensure you have read, and acted-upon, the information and steps in <a href="get-started-prepare.html" class="xref page">Prepare</a> and <a href="get-started-install.html" class="xref page">Install</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These instructions are for local or server based deployments.
If you are using a container such as Docker, see this
<a href="https://blog.couchbase.com/using-docker-with-couchbase-mobile/">blog post on using Docker with Couchbase Mobile</a> for additional details.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Steps in Getting Started</dt>
<dd>
<p><a href="introduction.html" class="xref page">Introduction</a>
 |
<a href="get-started-prepare.html" class="xref page">Prepare</a>
 |
<a href="get-started-install.html" class="xref page">Install</a>
 |
<strong>Verify</strong></p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this final step of the Getting Started topic we will look to link your <em>Sync&#160;Gateway</em> to a <em>Couchbase&#160;Server</em> bucket and verify that sync is taking place by executing a CRUD cycle.
You will need to edit the configuration file used in the <a href="get-started-install.html" class="xref page">Install</a> step to point to a bucket on your Couchbase&#160;Server&#8201;&#8212;&#8201;see <a href="#lbl-config">Bootstrap Sync Gateway</a>.</p>
</div>
<div class="paragraph">
<p>On completion of this topic you will have a working sync&#160;gateway instance that you know syncs with a Couchbase&#160;Server.
You will have successfully completed installation and can now build on this with confidence.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lbl-config"><a class="anchor" href="#lbl-config"></a>Bootstrap Sync Gateway</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure sync&#160;gateway to connect to a Couchbase&#160;Server:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure your sync&#160;gateway service is stopped/unloaded</p>
</li>
<li>
<p>Edit the configuration file you used in <a href="get-started-install.html" class="xref page">Install</a> and replace the contents with those shown in <a href="#sample-cfg">Example 1</a>.</p>
<div class="paragraph">
<p>The configuration points to your Couchbase&#160;Server cluster, which we will use to verify that you can synchronize changes made through the sync&#160;gateway API with those made through Couchbase&#160;Server.</p>
</div>
</li>
<li>
<p>Ensure you start Couchbase&#160;Server</p>
</li>
<li>
<p>Restart/Load your sync&#160;gateway  to pick-up the changed configuration</p>
</li>
</ol>
</div>
<div id="sample-cfg" class="exampleblock">
<div class="title">Example 1. Simple Sync Gateway Bootstrap Config</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "bootstrap": {
    "server": "couchbases://localhost", <i class="conum" data-value="1"></i><b>(1)</b>
    "username": "sync_gateway", <i class="conum" data-value="2"></i><b>(2)</b>
    "password": "password",
    "server_tls_skip_verify": true, <i class="conum" data-value="3"></i><b>(3)</b>
    "use_tls_server": true <i class="conum" data-value="4"></i><b>(4)</b>
  },
  "logging": { <i class="conum" data-value="5"></i><b>(5)</b>
    "console": {
      "enabled": true,
      "log_level": "info",
      "log_keys": ["*"]
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>About the Configuration Properties:</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here we point to the Couchbase&#160;Server cluster using secure connection. Server ships with self signed certs that work out of the box, as long as <code>server_tls_skip_verify</code> is set, as it is below.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here we provide the credentials for the RBAC user that you created on the Couchbase&#160;Server Admin Console&#8201;&#8212;&#8201;see <a href="get-started-prepare.html#configure-server" class="xref page">Configure Server for Sync Gateway</a></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Here we opt to ignore CA Cert verification of the certificate presented by the server; allowing for example use of self-signed certificate. The connection is unverified but encrypted.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Optionally, you can choose to run without TLS, by setting this value <code>false</code>.
In that case you should also use the plaintext URI <code>couchbase://localhost</code> to connect.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Define your logging requirements:<br>
Here we set general diagnostic console logs on.
If you&#8217;re having issues then refer to <a href="logging.html" class="xref page">Logging</a> for how to tune diagnostics to provide additional troubleshooting help</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<div class="title">Start Sync Gateway</div>
<p>Run the following in a terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">bin/sync_gateway -&lt;options&gt; sgwconfig.json <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Optionally provide any CLI flags you require to use</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="add-a-database-configuration"><a class="anchor" href="#add-a-database-configuration"></a>Add a Database Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We can now use the Admin REST API to add a database to our sync&#160;gateway cluster.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>curl</code> commands on this page requires basic authentication using the <code>api_admin</code> Couchbase&#160;Server RBAC user&#8217;s credentials we created in Step 2 of <a href="get-started-prepare.html#step-2create-rbac-user" class="xref page">Create RBAC users</a>.
You can create the digest by taking a Base64 of <code>username:password</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">DIGEST=`echo -n sync_gateway:password | base64`
echo $DIGEST
# c3luY19nYXRld2F5OnBhc3N3b3Jk

curl --header "Authorization: Basic $DIGEST" ...</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>curl</code> command shown in <a href="#ex-add-sgw-db">Example 2</a> below a <code>traveldb</code> database pointing to the Couchbase&#160;Server&#8217;s <code>travel-sample</code> bucket.</p>
</div>
<div id="ex-add-sgw-db" class="exampleblock">
<div class="title">Example 2. Add a Sync Gateway Database</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl  --location --request PUT 'http://127.0.0.1:4985/traveldb/' \<i class="conum" data-value="1"></i><b>(1)</b>
      --header "Authorization: Basic $DIGEST" \
      --header 'Content-Type: application/json' \
      --data-raw '{
          "bucket": "travel-sample", <i class="conum" data-value="2"></i><b>(2)</b>
          "num_index_replicas": 0 <i class="conum" data-value="3"></i><b>(3)</b>
          }'</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here we specify the name of the sync&#160;gateway database&#8201;&#8212;&#8201;<code>traveldb</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Now we point <code>traveldb</code> at the Couchbase&#160;Server bucket <code>travel-sample</code>, which we created in <a href="get-started-prepare.html#configure-server" class="xref page">Configure Server for Sync Gateway</a></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Set to zero for this example database</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="add-a-sync-gateway-user"><a class="anchor" href="#add-a-sync-gateway-user"></a>Add a Sync Gateway User</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We can now create a sync&#160;gateway user and role to allow secure access during replication on this sync&#160;gateway cluster.</p>
</div>
<div class="sect2">
<h3 id="add-a-role"><a class="anchor" href="#add-a-role"></a>Add a role</h3>
<div class="paragraph">
<p>The <code>curl</code> command shown in <a href="#ex-add-role">Example 3</a> requires basic authentication using the <code>api_admin</code> Couchbase&#160;Server RBAC user&#8217;s credentials we created in Step 2 of <a href="get-started-prepare.html#step-2create-rbac-user" class="xref page">Create RBAC users</a>.
It adds a role called <code>stdrole</code>.</p>
</div>
<div id="ex-add-role" class="exampleblock">
<div class="title">Example 3. Add a Sync Gateway Role</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl  --location --request PUT 'http://127.0.0.1:4985/traveldb/_role/stdrole' \<i class="conum" data-value="1"></i><b>(1)</b>
      --header "Authorization: Basic $DIGEST" \
      --header 'Content-Type: application/json' \
      --data-raw '{
          "name": "stdrole",
          "admin_channels": ["newrolechannel"] <i class="conum" data-value="2"></i><b>(2)</b>
      }'</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here we identify the name of the sync&#160;gateway database&#8201;&#8212;&#8201;<code>traveldb</code><br>
The action, <code>_role</code> and<br>
The role&#8217;s name <code>stdrole</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Now we identify the channels accessible to users assigned this role; these will be used by the Sync Function to control access.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="add-the-user"><a class="anchor" href="#add-the-user"></a>Add the user</h3>
<div class="paragraph">
<p>The <code>curl</code> command shown in <a href="#ex-add-user">Example 4</a> requires basic authentication using the <code>api_admin</code> Couchbase&#160;Server RBAC user&#8217;s credentials we created in Step 2 of <a href="get-started-prepare.html#step-2create-rbac-user" class="xref page">Create RBAC users</a>.
It adds a user called <code>sgwuser1</code>.</p>
</div>
<div id="ex-add-user" class="exampleblock">
<div class="title">Example 4. Add a Sync Gateway User</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl  --location -g --request POST 'http://localhost:4985/traveldb/_user/' \<i class="conum" data-value="1"></i><b>(1)</b>
      --header 'Content-Type: application/json' \
      --header "Authorization: Basic $DIGEST" \<i class="conum" data-value="2"></i><b>(2)</b>
      --data-raw '{
          "name": "sgwuser1", <i class="conum" data-value="3"></i><b>(3)</b>
          "password": "passwordstring",
          "roles": ["stdrole"] <i class="conum" data-value="4"></i><b>(4)</b>
          "admin_channels": ["public"] <i class="conum" data-value="5"></i><b>(5)</b>
      }'</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here we identify the name of the sync&#160;gateway database&#8201;&#8212;&#8201;<code>traveldb</code> and the required object, <code>_user</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The user/password credential represented in the <em>Authorization</em> header relate to the Sync Gateway admin user</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Here we give the credentials of the user we want to create. So, the user&#8217;s name <code>sgwuser1</code> and required password.
If we omit the password a random password is generated.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Now we identify any roles accessible to this user; it will inherit any channels associated with the role(s).</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Now we identify any channels accessible to this user, in addition to those inherited from the role; these will be used by the Sync Function to control access.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connect-to-sync-gateway"><a class="anchor" href="#connect-to-sync-gateway"></a>Connect to Sync Gateway</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can use <a href="#{sgw-pg-logging}.adoc#lbl-console-logs" class="xref unresolved">Console Logs</a> to aid diagnosis of connection issues
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>With sync&#160;gateway and Couchbase&#160;Server started, point your browser to the sync&#160;gateway url, typically on port 4984, but this can be changed&#8201;&#8212;&#8201;see: <a href="rest-api-access.html" class="xref page">REST API Access</a>.</p>
<div class="paragraph">
<p>So, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">http://localhost:4984</code></pre>
</div>
</div>
</li>
<li>
<p>Check that you receive a response similar to this:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"couchdb":"Welcome","vendor":{"name":"Couchbase Sync Gateway","version":"3.0"},"version":"Couchbase sync&#160;gateway/{version-full}(376;e2e7d42) EE"}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If there are issues then check the <a href="#{sgw-pg-logging}.adoc#lbl-console-logs" class="xref unresolved">Console Logs</a> for more information.
Where necessary you can redirect console output to a file&#8201;&#8212;&#8201;see: <a href="#{sgw-pg-logging}.adoc#lbl-log-redirect" class="xref unresolved">Redirect Console Logs</a>.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If sync&#160;gateway is behind a load balancer then check the websockets configuration&#8201;&#8212;&#8201;see <a href="load-balancer.html" class="xref page">Load Balancer</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="verify-the-crud-cycle"><a class="anchor" href="#verify-the-crud-cycle"></a>Verify the CRUD Cycle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here we will use CURL and sync&#160;gateway&#8217;s REST API to</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#lbl-crud-crt">Create a New Document:</a> Use the API to add a document and check the document on Couchbase&#160;Server</p>
</li>
<li>
<p><a href="#lbl-crud-get">Get a Document Using the API:</a> Read the document back from Couchbase&#160;Server using the sync&#160;gateway API</p>
</li>
<li>
<p><a href="#lbl-crud-upd">Update a Document using API:</a> Update the newly created document and observe the changes in Couchbase&#160;Server</p>
</li>
<li>
<p><a href="#lbl-crud-upd-svr">Sync a Couchbase Server Change</a> Update the document in Couchase Server and check the change in sync&#160;gateway</p>
</li>
<li>
<p><a href="#lbl-crud-del">Delete a Document Using API</a> Delete our document and check its state on Couchbase&#160;Server and sync&#160;gateway.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remember to use the credentials of the Couchbase&#160;Server RBAC user for authentication.</p>
</div>
<div class="sect2">
<h3 id="lbl-crud-crt"><a class="anchor" href="#lbl-crud-crt"></a>Create a New Document:</h3>
<div class="paragraph">
<p>Within a terminal use CURL to issue the following POST request, which adds a new document to the Couchbase&#160;Server bucket <code>get-started-bucket</code> by way of the sync&#160;gateway database <code>get-started-bucket</code> we configured in <a href="#lbl-config">Bootstrap Sync Gateway</a></p>
</div>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">DIGEST=`echo -n sgwuser1:password | base64`

curl  --location --request PUT 'http://localhost:4985/traveldb/hotel_88801' \
      --header "Authorization: Basic $DIGEST" \
      --header 'Content-Type: application/json' \
      --data-raw '{
          "_id": "hotel_88801",
          "id": "88801",
          "type": "hotel",
          "name": "Verify-Install Topic",
          "address": "The Shambles",
          "city": "Manchester",
          "country": "United Kingdom"
      }'</code></pre>
</div>
</div>
<div id="lbl-crud-add-resp" class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"id":"hotel_88801",
"ok":true,
"rev":"1-f28b5cc13a38892f4f85913d4e654270"}</code></pre>
</div>
</div>
<div id="lbl-check-cbs" class="paragraph">
<div class="title">Check</div>
<p>View the document in Couchbase&#160;Server Admin Console to verify it syncs from sync&#160;gateway database.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Within the Admin Console, select <strong>Buckets</strong> and hit the <b class="button">Documents</b> button to open the <em>Document Editor</em> tab.</p>
</li>
<li>
<p>Within the <em>Document Editor</em> tab:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Enter <code>travel-sample</code> as <em>Bucket</em></p>
</li>
<li>
<p>Leave <em>Scope</em> and <em>Collection</em> as <code>_default</code></p>
</li>
<li>
<p>Enter <code>id="88801"</code> as <em>M1QL WHERE</em> query</p>
</li>
<li>
<p><kbd>Enter</kbd></p>
<div class="paragraph">
<p>You will see the response shown in <a href="#img-cbs-view">Figure 1</a>.
The document should include any changes made through sync&#160;gateway, including the initial create.</p>
</div>
<div id="img-cbs-view" class="imageblock">
<div class="content">
<img src="_images/cbs-view-first-doc.png" alt="cbs view first doc">
</div>
<div class="title">Figure 1. Couchbase Server Document Editor</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="lbl-crud-get"><a class="anchor" href="#lbl-crud-get"></a>Get a Document Using the API:</h3>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl  --location --request GET 'http://localhost:4985/traveldb/hotel_88801' \
      --header "Authorization: Basic $DIGEST"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{
    "_id": "hotel_88801",
    "_rev": "1-f28b5cc13a38892f4f85913d4e654270",
    "address": "The Shambles",
    "city": "Manchester",
    "country": "United Kingdom",
    "id": "88801",
    "name": "Verify-Install Topic",
    "type": "hotel"
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lbl-crud-upd"><a class="anchor" href="#lbl-crud-upd"></a>Update a Document using API:</h3>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl  --location -g \
      --request PUT 'http://localhost:4985/traveldb/hotel_88801?new_edits=true&amp;rev=1-f28b5cc13a38892f4f85913d4e654270' \<i class="conum" data-value="1"></i><b>(1)</b>
      --header 'Accept: application/json' \
      --header 'Content-Type: application/json' \
      --data-raw '{
        "_id": "hotel_88801",
        "id": "88801",
        "type": "hotel"
        "name": "Verify-Install Topic Updated", <i class="conum" data-value="2"></i><b>(2)</b>
        "address": "The Shambles",
        "city": "Manchester",
        "country": "United Kingdom",
        "email": "enquiries@hotel_88801.internet" <i class="conum" data-value="3"></i><b>(3)</b>
      }'</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This revision is the one returned by the response to the initial POST request&#8201;&#8212;&#8201;see: <a href="#lbl-crud-add-resp">Response to Add Document Request</a></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here we change the text of the <em>name</em> field.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Here we add an <em>email</em> field.</td>
</tr>
</table>
</div>
<div id="lbl-crud-upd-resp" class="listingblock">
<div class="title">Response</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{
    "id": "hotel_88801",
    "ok": true,
    "rev": "2-249366b198e81f203d7ae9eb54376210"  <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here the <code>"ok":true</code> indicates success, whilst the revision shows it is the second change to this document.</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Check</div>
<p><a href="#lbl-check-cbs">Check Document on Couchbase Server</a>.
Does the document contain the changed <em>data</em> value?</p>
</div>
</div>
<div class="sect2">
<h3 id="lbl-crud-upd-svr"><a class="anchor" href="#lbl-crud-upd-svr"></a>Sync a Couchbase Server Change</h3>
<div class="paragraph">
<p>This will show that changes made using Couchbase&#160;Server are replicated to sync&#160;gateway.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Within the Couchbase&#160;Server Document Editor</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Retrieve <code>88801</code> if it is not currently displayed<br>
Use <code>meta().id="hotel_88801"</code> as query</p>
</li>
<li>
<p>Edit the <em>email</em> value to contain <code>reception@hotel_88801.internet</code></p>
</li>
<li>
<p>Edit the <em>name</em> value to contain <code>Verify-Install Topic-Updated-In-Server</code></p>
</li>
<li>
<p><b class="button">Save</b> the change.<br></p>
</li>
</ol>
</div>
</li>
<li>
<p>In your terminal, use the API to get the document again&#8201;&#8212;&#8201;see <a href="#lbl-crud-get">Get a Document Using the API:</a><br>
You should see the change you made in Couchbase&#160;Server reflected in the response. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"_id":"hotel_88801","_rev":"3-cc2e758ef63b0daf5b01b2baf98c72b6", <i class="conum" data-value="1"></i><b>(1)</b>
"address":"The Shambles","city":"Manchester","country":"United Kingdom","email":"reception@hotel_88801.internet","id":"88801","name":"Verify-Install Topic-Updated-In-Server","type":"hotel"}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Note that the revision sequence is now 3, up from the 2 returned in our <a href="#lbl-crud-upd-resp">Response to Update Document Request</a></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Note that the <em>email</em> and <em>name</em> fielda now contains both the change made in sync&#160;gateway and the amendment made in Couchbase&#160;Server ("reception")</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="lbl-crud-del"><a class="anchor" href="#lbl-crud-del"></a>Delete a Document Using API</h3>
<div class="listingblock">
<div class="title">Request</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl --location -g --request DELETE 'http://localhost:4985/traveldb/88801?rev=3-cc2e758ef63b0daf5b01b2baf98c72b6' <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Note that we provide here the revision ID of the latest revision (3), as returned in the response to the last GET request.</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Response</div>
<p>You should see the following response:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{
    "id": "hotel_88801",
    "ok": true,
    "rev": "4-03f1ba127340e8c50c31a36279298e60" <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>You can see here that the delete counts as the fourth change/revision. Again "ok":true indicates the delete was successful.</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Check</div>
<ul>
<li>
<p><a href="#lbl-check-cbs">Check Document on Couchbase Server</a> and you should now see "No Results"</p>
</li>
<li>
<p>Use the API to get the document&#8201;&#8212;&#8201;see:  <a href="#lbl-crud-get">Get a Document Using the API:</a>.
Assuming the delete worked you should see the following response:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">{"error":"not_found","reason":"deleted"}%</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ways-to-verify-sync"><a class="anchor" href="#ways-to-verify-sync"></a>Ways to Verify Sync</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To verify that document changes have been replicated, you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Monitor the sync&#160;gateway revision number returned by the database endpoint (<a href="rest-api.html#/database/get__db__" class="xref page">GET /{tkn-db}/</a>).
The revision number increments for every change that happens on the sync&#160;gateway database.</p>
</li>
<li>
<p>Query a document by ID on the sync&#160;gateway REST API as shown in <a href="#lbl-check-cbs">Check Document on Couchbase Server</a>. Use (<a href="rest-api.html#/document/get__db___doc_" class="xref page">GET /{tkn-db}/{id}</a>)&#8201;&#8212;&#8201;see: <a href="rest-api-access.html" class="xref page">REST API Access</a> for more.</p>
</li>
<li>
<p>Query a document from the Query Workbench on the Couchbase&#160;Server Console.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Next Steps</div>
<div class="paragraph">
<p>Now you know sync&#160;gateway is deployed and operational.
So, you can explore more complex scenarios with confidence.</p>
</div>
<div class="paragraph">
<p>Maybe you want to learn more about sync&#160;gateway&#8217;s <a href="configuration-schema-bootstrap.html" class="xref page">Bootstrap Configuration</a> or how to <a href="sync-with-couchbase-server.html" class="xref page">Sync with Couchbase Server</a>. Or perhaps you want to explore how to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implement access controls for users and data&#8201;&#8212;&#8201;see: <a href="users.html" class="xref page">Users</a>, <a href="roles.html" class="xref page">Roles</a> and the <a href="sync-function.html" class="xref page">Sync Function</a> that ties it all together.</p>
</li>
<li>
<p>Implement secure connectivity using TLS/SSL, which is described in <a href="authentication-users.html" class="xref page">User Authentication</a> and <a href="authentication-certs.html" class="xref page">TLS Certificate Authentication</a></p>
</li>
<li>
<p>Build more complex syncs, such as those that sync with:</p>
<div class="ulist">
<ul>
<li>
<p>Other sync&#160;gateway nodes, for which see <a href="sync-inter-syncgateway-overview.html" class="xref page">Inter Sync Gateway Sync - Overview</a></p>
</li>
<li>
<p>Apps on mobile devices using Couchbase Lite&#8201;&#8212;&#8201;see <a href="sync-using-app.html" class="xref page">Sync Using App</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<hr>
<h5 id="" class="discrete"></h5>
</div>
</div>
<div class="sect1">
<h2 id="related-content"><a class="anchor" href="#related-content"></a>Related Content</h2>
<div class="sectionbody">
<div class="card-row three-column-row">
<div class="sect5 column">
<h6 id="-2"><a class="anchor" href="#-2"></a></h6>
<div class="ulist">
<div class="title">Getting Started</div>
<ul>
<li>
<p><a href="get-started-prepare.html" class="xref page">Prepare</a></p>
</li>
<li>
<p><a href="get-started-install.html" class="xref page">Install</a></p>
</li>
<li>
<p><a href="#">Verify</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-3"><a class="anchor" href="#-3"></a></h6>
<div class="ulist">
<div class="title">Product Information</div>
<ul>
<li>
<p><a href="release-notes.html" class="xref page">Release Notes</a></p>
</li>
<li>
<p><a href="compatibility.html" class="xref page">Compatibility Matrix</a></p>
</li>
<li>
<p><a href="supported-environments.html" class="xref page">Supported OS</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-4"><a class="anchor" href="#-4"></a></h6>
<div class="paragraph">
<div class="title">Community</div>
<p><a href="https://forums.couchbase.com/c/mobile/14">Mobile Forum</a> |
<a href="https://blog.couchbase.com/">Blog</a> |
<a href="https://blog.couchbase.com/category/couchbase-mobile/?ref=blog-menu">Blog (Mobile)</a> |
<a href="https://docs.couchbase.com/tutorials/">Tutorials</a></p>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>Â© 2022 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../_/js/site-navigation-data.js"></script>
<script id="page-navigation-group" type="application/json">
{"title":"Mobile","components":["sync-gateway"],"url":"/home/mobile.html","latestVersions":{"sync-gateway":"3.0"}}
</script>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../_/js/site.js"></script>
<script defer src="../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
</body>
</html>
